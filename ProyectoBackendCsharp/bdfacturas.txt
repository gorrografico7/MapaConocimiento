-- Creación de la tabla Persona
CREATE TABLE Persona (
    codigo VARCHAR(255) PRIMARY KEY,
    email VARCHAR(255),
    nombre VARCHAR(255),
    telefono VARCHAR(255)
);

-- Creación de la tabla Vendedor que hereda de Persona
CREATE TABLE Vendedor (
    codigo VARCHAR(255) PRIMARY KEY,
    carnet INT,
    direccion VARCHAR(255),
    FOREIGN KEY (codigo) REFERENCES Persona(codigo)
);

-- Creación de la tabla Empresa
CREATE TABLE Empresa (
    codigo VARCHAR(255) PRIMARY KEY,
    nombre VARCHAR(255)
);

-- Creación de la tabla Cliente que hereda de Persona
CREATE TABLE Cliente (
    codigo VARCHAR(255) PRIMARY KEY,
    credito FLOAT,
    codigo_empresa VARCHAR(255), -- Agregación con Empresa
    FOREIGN KEY (codigo) REFERENCES Persona(codigo),
    FOREIGN KEY (codigo_empresa) REFERENCES Empresa(codigo)
);

-- Creación de la tabla Producto
CREATE TABLE Producto (
    codigo VARCHAR(255) PRIMARY KEY,
    nombre VARCHAR(255),
    stock INT,
    valorUnitario FLOAT
);

-- Creación de la tabla Factura con número autonumérico y fecha predeterminada
CREATE TABLE Factura (
    numero BIGINT IDENTITY(1,1) PRIMARY KEY,
    fecha DATE DEFAULT GETDATE(),
    total FLOAT,
    codigo_cliente VARCHAR(255),
    FOREIGN KEY (codigo_cliente) REFERENCES Cliente(codigo)
);


-- Creación de la tabla ProductosPorFactura
CREATE TABLE ProductosPorFactura (
    numero_factura BIGINT,
    codigo_producto VARCHAR(255),
    cantidad INT,
    subtotal FLOAT,
    PRIMARY KEY (numero_factura, codigo_producto),
    FOREIGN KEY (numero_factura) REFERENCES Factura(numero),
    FOREIGN KEY (codigo_producto) REFERENCES Producto(codigo)
);
